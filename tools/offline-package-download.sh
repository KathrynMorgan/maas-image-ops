#!/bin/bash -x
# add /etc/apt/sources.list.d/maas-image-builder.list
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BEEF83C77C14C957 && apt update
apt_PKG_LIST="adwaita-icon-theme at-spi2-core binfmt-support binutils build-essential colord colord-data cpp cpp-5 dconf-gsettings-backend dconf-service dos2unix dpkg-dev fakeroot fontconfig fontconfig-config fonts-dejavu-core g++ g++-5 gcc gcc-5 genisoimage gir1.2-freedesktop gir1.2-libosinfo-1.0 glib-networking glib-networking-common glib-networking-services gsettings-desktop-schemas hicolor-icon-theme humanity-icon-theme kpartx libalgorithm-diff-perl libalgorithm-diff-xs-perl libalgorithm-merge-perl libapr1 libaprutil1 libasan2 libatk-bridge2.0-0 libatk1.0-0 libatk1.0-data libatomic1 libatspi2.0-0 libboost-filesystem1.58.0 libc-dev-bin libc6-dev libcairo-gobject2 libcairo2 libcapnp-0.5.3 libcc1-0 libcilkrts5 libcolord2 libcolorhug2 libcroco3 libcups2 libdatrie1 libdconf1 libdpkg-perl libdrm-amdgpu1 libdrm-intel1 libdrm-nouveau2 libdrm-radeon1 libegl1-mesa libepoxy0 libexif12 libfakeroot libfile-fcntllock-perl libfontconfig1 libgbm1 libgcc-5-dev libgd3 libgdk-pixbuf2.0-0 libgdk-pixbuf2.0-common libgl1-mesa-dri libglapi-mesa libgomp1 libgphoto2-6 libgphoto2-l10n libgphoto2-port12 libgraphite2-3 libgtk-3-0 libgtk-3-bin libgtk-3-common libgtk-vnc-2.0-0 libgudev-1.0-0 libgusb2 libgvnc-1.0-0 libharfbuzz0b libieee1284-3 libisl15 libitm1 libjbig0 libjson-glib-1.0-0 libjson-glib-1.0-common liblcms2-2 libllvm6.0 liblsan0 libltdl7 libmirclient9 libmircommon7 libmircore1 libmirprotobuf3 libmpc3 libmpx0 libosinfo-1.0-0 libpango-1.0-0 libpangocairo-1.0-0 libpangoft2-1.0-0 libprotobuf-lite9v5 libproxy1v5 libpulse-mainloop-glib0 libpython-stdlib libpython2.7 libpython2.7-minimal libpython2.7-stdlib libquadmath0 librest-0.7-0 librsvg2-2 librsvg2-common libsane libsane-common libsensors4 libserf-1-1 libsoup-gnome2.4-1 libsoup2.4-1 libspice-client-glib-2.0-8 libspice-client-gtk-3.0-4 libstdc++-5-dev libsvn1 libthai-data libthai0 libtiff5 libtsan0 libtxc-dxtn-s2tc0 libubsan0 libusbredirhost1 libvpx3 libwayland-client0 libwayland-cursor0 libwayland-egl1-mesa libwayland-server0 libx11-xcb1 libxcb-dri2-0 libxcb-dri3-0 libxcb-present0 libxcb-render0 libxcb-shm0 libxcb-sync1 libxcb-xfixes0 libxcomposite1 libxcursor1 libxdamage1 libxfixes3 libxi6 libxinerama1 libxkbcommon0 libxpm4 libxrandr2 libxrender1 libxshmfence1 libxtst6 linux-libc-dev maas-image-builder make manpages-dev mib-common python python-cffi-backend python-chardet python-cryptography python-enum34 python-gi python-idna python-ipaddr python-ipaddress python-libvirt python-libxml2 python-minimal python-ndg-httpsclient python-openssl python-pkg-resources python-pyasn1 python-requests python-six python-urllib3 python2.7 python2.7-minimal python3-mib python3-pbr python3-stevedore python3-tempita qemu qemu-slof qemu-system ubuntu-mono adwaita-icon-theme adwaita-icon-theme spice-client-glib-usb-acl-helper libspice-client-glib-2.0-8 x11-common unzip virtinst qemu-system-arm qemu-system-mips qemu-system-ppc qemu-system-sparc qemu-system-misc qemu-system qemu-user qemu-user-binfmt libxtst6 libgtk-3-common libgtk-3-0 libgtk-3-common libgtk-3-0 python3-mib virt-viewer"


mkdir ~/Downloads/maas-image-builder-offline -p
cd ~/Downloads/maas-image-builder-offline/
apt-get download $apt_PKG_LIST && cd ~ && tar -Jcvf maas-image-builder-offline.tar.xz ~/Downloads/maas-image-builder-offline/
# on target with tarball; do; tar xvf maas-image-builder-offline.tar.xz && cd ~path && apt-get install ./*.deb
